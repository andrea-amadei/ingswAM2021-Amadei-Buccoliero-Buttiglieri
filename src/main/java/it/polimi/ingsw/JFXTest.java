package it.polimi.ingsw;

import it.polimi.ingsw.client.ClientGameBuilder;
import it.polimi.ingsw.client.gui.GuiBuilder;
import it.polimi.ingsw.client.gui.GuiSceneManager;
import it.polimi.ingsw.client.gui.controllers.BoardGuiController;
import it.polimi.ingsw.client.gui.updaters.LobbyPersonalDataGuiUpdater;
import it.polimi.ingsw.client.model.ClientModel;
import it.polimi.ingsw.client.model.PersonalData;
import it.polimi.ingsw.exceptions.ParserException;
import it.polimi.ingsw.utils.Pair;
import it.polimi.ingsw.utils.ResourceLoader;
import javafx.application.Application;
import javafx.fxml.FXMLLoader;
import javafx.scene.Parent;
import javafx.scene.Scene;
import javafx.scene.SceneAntialiasing;
import javafx.scene.image.Image;
import javafx.scene.image.ImageView;
import javafx.scene.input.KeyCombination;
import javafx.stage.Stage;

import javax.imageio.ImageIO;
import java.io.IOException;
import java.util.Arrays;

public class JFXTest extends Application {

    private static Scene scene;

    @Override
    public void start(Stage stage) throws IOException, ParserException {
        ClientModel model = new ClientModel();
        ClientGameBuilder.buildGame(model, Arrays.asList("Pippo", "Pluto", "Paperino"),
                "{\"max_username_length\":30,\"min_username_length\":2,\"max_card_level\":3,\"min_card_level\":1,\"amount_of_leaders_to_discard\":2,\"first_player_amount_of_faith_points_on_start\":0,\"second_player_amount_of_faith_points_on_start\":0,\"third_player_amount_of_faith_points_on_start\":1,\"fourth_player_amount_of_faith_points_on_start\":1,\"first_player_amount_of_resources_on_start\":0,\"second_player_amount_of_resources_on_start\":1,\"third_player_amount_of_resources_on_start\":1,\"fourth_player_amount_of_resources_on_start\":2,\"base_cupboard_shelf_names\":[\"TopShelf\",\"MiddleShelf\",\"BottomShelf\"],\"base_cupboard_shelf_types\":[\"any\",\"any\",\"any\"],\"base_cupboard_shelf_sizes\":[1,2,3],\"hand_id\":\"Hand\",\"basket_id\":\"MarketBasket\",\"chest_id\":\"Chest\",\"market_rows\":3,\"market_columns\":4,\"marble_per_color\":{\"BLUE\":2,\"WHITE\":4,\"GREY\":2,\"RED\":1,\"PURPLE\":2,\"YELLOW\":2},\"upgradable_crafting_number\":3,\"faith_checkpoint_number\":3}",
                "{\"shop\":[{\"id\":1,\"color\":\"GREEN\",\"level\":1,\"points\":1,\"cost\":{\"shield\":2},\"crafting\":{\"input\":{\"stone\":1},\"output\":{},\"faith_output\":1}},{\"id\":2,\"color\":\"PURPLE\",\"level\":1,\"points\":1,\"cost\":{\"servant\":2},\"crafting\":{\"input\":{\"stone\":1},\"output\":{},\"faith_output\":1}},{\"id\":3,\"color\":\"BLUE\",\"level\":1,\"points\":1,\"cost\":{\"gold\":2},\"crafting\":{\"input\":{\"shield\":1},\"output\":{},\"faith_output\":1}},{\"id\":4,\"color\":\"YELLOW\",\"level\":1,\"points\":1,\"cost\":{\"stone\":2},\"crafting\":{\"input\":{\"servant\":1},\"output\":{},\"faith_output\":1}},{\"id\":5,\"color\":\"GREEN\",\"level\":1,\"points\":2,\"cost\":{\"shield\":1,\"servant\":1,\"stone\":1},\"crafting\":{\"input\":{\"stone\":1},\"output\":{\"servant\":1},\"faith_output\":0}},{\"id\":6,\"color\":\"PURPLE\",\"level\":1,\"points\":2,\"cost\":{\"shield\":1,\"servant\":1,\"gold\":1},\"crafting\":{\"input\":{\"gold\":1},\"output\":{\"shield\":1},\"faith_output\":0}},{\"id\":7,\"color\":\"BLUE\",\"level\":1,\"points\":2,\"cost\":{\"gold\":1,\"servant\":1,\"stone\":1},\"crafting\":{\"input\":{\"servant\":1},\"output\":{\"stone\":1},\"faith_output\":0}},{\"id\":8,\"color\":\"YELLOW\",\"level\":1,\"points\":2,\"cost\":{\"shield\":1,\"stone\":1,\"gold\":1},\"crafting\":{\"input\":{\"shield\":1},\"output\":{\"gold\":1},\"faith_output\":0}},{\"id\":9,\"color\":\"GREEN\",\"level\":1,\"points\":3,\"cost\":{\"shield\":3},\"crafting\":{\"input\":{\"servant\":2},\"output\":{\"gold\":1,\"shield\":1,\"stone\":1},\"faith_output\":0}},{\"id\":10,\"color\":\"PURPLE\",\"level\":1,\"points\":3,\"cost\":{\"servant\":3},\"crafting\":{\"input\":{\"gold\":2},\"output\":{\"servant\":1,\"shield\":1,\"stone\":1},\"faith_output\":0}},{\"id\":11,\"color\":\"BLUE\",\"level\":1,\"points\":3,\"cost\":{\"gold\":3},\"crafting\":{\"input\":{\"stone\":2},\"output\":{\"gold\":1,\"servant\":1,\"shield\":1},\"faith_output\":0}},{\"id\":12,\"color\":\"YELLOW\",\"level\":1,\"points\":3,\"cost\":{\"stone\":3},\"crafting\":{\"input\":{\"shield\":2},\"output\":{\"gold\":1,\"servant\":1,\"stone\":1},\"faith_output\":0}},{\"id\":13,\"color\":\"GREEN\",\"level\":1,\"points\":4,\"cost\":{\"shield\":2,\"gold\":2},\"crafting\":{\"input\":{\"stone\":1,\"servant\":1},\"output\":{\"gold\":2},\"faith_output\":1}},{\"id\":14,\"color\":\"PURPLE\",\"level\":1,\"points\":4,\"cost\":{\"servant\":2,\"stone\":2},\"crafting\":{\"input\":{\"gold\":1,\"shield\":1},\"output\":{\"stone\":2},\"faith_output\":1}},{\"id\":15,\"color\":\"PURPLE\",\"level\":1,\"points\":4,\"cost\":{\"gold\":2,\"servant\":2},\"crafting\":{\"input\":{\"shield\":1,\"stone\":1},\"output\":{\"servant\":2},\"faith_output\":1}},{\"id\":16,\"color\":\"YELLOW\",\"level\":1,\"points\":4,\"cost\":{\"stone\":2,\"shield\":2},\"crafting\":{\"input\":{\"gold\":1,\"servant\":1},\"output\":{\"shield\":2},\"faith_output\":1}},{\"id\":17,\"color\":\"GREEN\",\"level\":2,\"points\":5,\"cost\":{\"shield\":4},\"crafting\":{\"input\":{\"stone\":1},\"output\":{},\"faith_output\":2}},{\"id\":18,\"color\":\"PURPLE\",\"level\":2,\"points\":5,\"cost\":{\"servant\":4},\"crafting\":{\"input\":{\"gold\":1},\"output\":{},\"faith_output\":2}},{\"id\":19,\"color\":\"BLUE\",\"level\":2,\"points\":5,\"cost\":{\"gold\":4},\"crafting\":{\"input\":{\"servant\":1},\"output\":{},\"faith_output\":2}},{\"id\":20,\"color\":\"YELLOW\",\"level\":2,\"points\":5,\"cost\":{\"stone\":4},\"crafting\":{\"input\":{\"shield\":1},\"output\":{},\"faith_output\":2}},{\"id\":21,\"color\":\"GREEN\",\"level\":2,\"points\":6,\"cost\":{\"shield\":3,\"servant\":2},\"crafting\":{\"input\":{\"shield\":1,\"servant\":1},\"output\":{\"stone\":3},\"faith_output\":0}},{\"id\":22,\"color\":\"PURPLE\",\"level\":2,\"points\":6,\"cost\":{\"servant\":3,\"gold\":2},\"crafting\":{\"input\":{\"gold\":1,\"servant\":1},\"output\":{\"shield\":3},\"faith_output\":0}},{\"id\":23,\"color\":\"BLUE\",\"level\":2,\"points\":6,\"cost\":{\"gold\":3,\"stone\":2},\"crafting\":{\"input\":{\"gold\":1,\"stone\":1},\"output\":{\"servant\":3},\"faith_output\":0}},{\"id\":24,\"color\":\"YELLOW\",\"level\":2,\"points\":6,\"cost\":{\"stone\":3,\"shield\":2},\"crafting\":{\"input\":{\"stone\":1,\"shield\":1},\"output\":{\"gold\":3},\"faith_output\":0}},{\"id\":25,\"color\":\"GREEN\",\"level\":2,\"points\":7,\"cost\":{\"shield\":5},\"crafting\":{\"input\":{\"gold\":2},\"output\":{\"stone\":2},\"faith_output\":2}},{\"id\":26,\"color\":\"PURPLE\",\"level\":2,\"points\":7,\"cost\":{\"servant\":5},\"crafting\":{\"input\":{\"stone\":2},\"output\":{\"gold\":2},\"faith_output\":2}},{\"id\":27,\"color\":\"BLUE\",\"level\":2,\"points\":7,\"cost\":{\"gold\":5},\"crafting\":{\"input\":{\"servant\":2},\"output\":{\"shield\":2},\"faith_output\":2}},{\"id\":28,\"color\":\"YELLOW\",\"level\":2,\"points\":7,\"cost\":{\"stone\":5},\"crafting\":{\"input\":{\"shield\":2},\"output\":{\"servant\":2},\"faith_output\":2}},{\"id\":29,\"color\":\"GREEN\",\"level\":2,\"points\":8,\"cost\":{\"shield\":3,\"gold\":3},\"crafting\":{\"input\":{\"gold\":1},\"output\":{\"shield\":2},\"faith_output\":1}},{\"id\":30,\"color\":\"PURPLE\",\"level\":2,\"points\":8,\"cost\":{\"servant\":3,\"shield\":3},\"crafting\":{\"input\":{\"stone\":1},\"output\":{\"servant\":2},\"faith_output\":1}},{\"id\":31,\"color\":\"BLUE\",\"level\":2,\"points\":8,\"cost\":{\"gold\":3,\"stone\":3},\"crafting\":{\"input\":{\"servant\":1},\"output\":{\"stone\":2},\"faith_output\":1}},{\"id\":32,\"color\":\"YELLOW\",\"level\":2,\"points\":8,\"cost\":{\"stone\":3,\"servant\":3},\"crafting\":{\"input\":{\"shield\":1},\"output\":{\"gold\":2},\"faith_output\":1}},{\"id\":33,\"color\":\"GREEN\",\"level\":3,\"points\":9,\"cost\":{\"shield\":6},\"crafting\":{\"input\":{\"gold\":2},\"output\":{\"stone\":3},\"faith_output\":2}},{\"id\":34,\"color\":\"PURPLE\",\"level\":3,\"points\":9,\"cost\":{\"servant\":6},\"crafting\":{\"input\":{\"stone\":2},\"output\":{\"gold\":3},\"faith_output\":2}},{\"id\":35,\"color\":\"BLUE\",\"level\":3,\"points\":9,\"cost\":{\"gold\":6},\"crafting\":{\"input\":{\"servant\":2},\"output\":{\"shield\":3},\"faith_output\":2}},{\"id\":36,\"color\":\"YELLOW\",\"level\":3,\"points\":9,\"cost\":{\"stone\":6},\"crafting\":{\"input\":{\"shield\":2},\"output\":{\"servant\":3},\"faith_output\":2}},{\"id\":37,\"color\":\"GREEN\",\"level\":3,\"points\":10,\"cost\":{\"shield\":5,\"servant\":2},\"crafting\":{\"input\":{\"gold\":1,\"servant\":1},\"output\":{\"shield\":2,\"stone\":2},\"faith_output\":1}},{\"id\":38,\"color\":\"PURPLE\",\"level\":3,\"points\":10,\"cost\":{\"servant\":5,\"gold\":2},\"crafting\":{\"input\":{\"stone\":1,\"shield\":1},\"output\":{\"gold\":2,\"servant\":2},\"faith_output\":1}},{\"id\":39,\"color\":\"BLUE\",\"level\":3,\"points\":10,\"cost\":{\"gold\":5,\"stone\":2},\"crafting\":{\"input\":{\"gold\":1,\"shield\":1},\"output\":{\"servant\":2,\"stone\":2},\"faith_output\":1}},{\"id\":40,\"color\":\"YELLOW\",\"level\":3,\"points\":10,\"cost\":{\"stone\":5,\"servant\":2},\"crafting\":{\"input\":{\"stone\":1,\"servant\":1},\"output\":{\"gold\":2,\"shield\":2},\"faith_output\":1}},{\"id\":41,\"color\":\"GREEN\",\"level\":3,\"points\":11,\"cost\":{\"shield\":7},\"crafting\":{\"input\":{\"servant\":1},\"output\":{\"gold\":1},\"faith_output\":3}},{\"id\":42,\"color\":\"PURPLE\",\"level\":3,\"points\":11,\"cost\":{\"servant\":7},\"crafting\":{\"input\":{\"gold\":1},\"output\":{\"stone\":1},\"faith_output\":3}},{\"id\":43,\"color\":\"BLUE\",\"level\":3,\"points\":11,\"cost\":{\"gold\":7},\"crafting\":{\"input\":{\"stone\":1},\"output\":{\"shield\":1},\"faith_output\":3}},{\"id\":44,\"color\":\"YELLOW\",\"level\":3,\"points\":11,\"cost\":{\"stone\":7},\"crafting\":{\"input\":{\"shield\":1},\"output\":{\"servant\":1},\"faith_output\":3}},{\"id\":45,\"color\":\"GREEN\",\"level\":3,\"points\":12,\"cost\":{\"shield\":4,\"gold\":4},\"crafting\":{\"input\":{\"stone\":1},\"output\":{\"gold\":3,\"shield\":1},\"faith_output\":0}},{\"id\":46,\"color\":\"PURPLE\",\"level\":3,\"points\":12,\"cost\":{\"servant\":4,\"shield\":4},\"crafting\":{\"input\":{\"gold\":1},\"output\":{\"stone\":3,\"servant\":1},\"faith_output\":0}},{\"id\":47,\"color\":\"BLUE\",\"level\":3,\"points\":12,\"cost\":{\"gold\":4,\"stone\":4},\"crafting\":{\"input\":{\"servant\":1},\"output\":{\"shield\":3,\"gold\":1},\"faith_output\":0}},{\"id\":48,\"color\":\"YELLOW\",\"level\":3,\"points\":12,\"cost\":{\"stone\":4,\"servant\":4},\"crafting\":{\"input\":{\"shield\":1},\"output\":{\"servant\":3,\"stone\":1},\"faith_output\":0}}],\"base\":[{\"input\":{\"any\":2},\"output\":{\"any\":1},\"faith_output\":0}]}",
                "{\"tiles\":[{\"order\":0,\"x\":1,\"y\":1,\"points\":0,\"pope_group\":0,\"pope_check\":false},{\"order\":1,\"x\":2,\"y\":1,\"points\":0,\"pope_group\":0,\"pope_check\":false},{\"order\":2,\"x\":3,\"y\":1,\"points\":0,\"pope_group\":0,\"pope_check\":false},{\"order\":3,\"x\":3,\"y\":2,\"points\":1,\"pope_group\":0,\"pope_check\":false},{\"order\":4,\"x\":3,\"y\":3,\"points\":0,\"pope_group\":0,\"pope_check\":false},{\"order\":5,\"x\":4,\"y\":3,\"points\":0,\"pope_group\":1,\"pope_check\":false},{\"order\":6,\"x\":5,\"y\":3,\"points\":1,\"pope_group\":1,\"pope_check\":false},{\"order\":7,\"x\":6,\"y\":3,\"points\":0,\"pope_group\":1,\"pope_check\":false},{\"order\":8,\"x\":7,\"y\":3,\"points\":0,\"pope_group\":1,\"pope_check\":true},{\"order\":9,\"x\":8,\"y\":3,\"points\":2,\"pope_group\":0,\"pope_check\":false},{\"order\":10,\"x\":8,\"y\":2,\"points\":0,\"pope_group\":0,\"pope_check\":false},{\"order\":11,\"x\":8,\"y\":1,\"points\":0,\"pope_group\":0,\"pope_check\":false},{\"order\":12,\"x\":9,\"y\":1,\"points\":2,\"pope_group\":2,\"pope_check\":false},{\"order\":13,\"x\":10,\"y\":1,\"points\":0,\"pope_group\":2,\"pope_check\":false},{\"order\":14,\"x\":11,\"y\":1,\"points\":0,\"pope_group\":2,\"pope_check\":false},{\"order\":15,\"x\":12,\"y\":1,\"points\":3,\"pope_group\":2,\"pope_check\":false},{\"order\":16,\"x\":13,\"y\":1,\"points\":0,\"pope_group\":2,\"pope_check\":true},{\"order\":17,\"x\":13,\"y\":2,\"points\":0,\"pope_group\":0,\"pope_check\":false},{\"order\":18,\"x\":13,\"y\":3,\"points\":3,\"pope_group\":0,\"pope_check\":false},{\"order\":19,\"x\":14,\"y\":3,\"points\":0,\"pope_group\":3,\"pope_check\":false},{\"order\":20,\"x\":15,\"y\":3,\"points\":0,\"pope_group\":3,\"pope_check\":false},{\"order\":21,\"x\":16,\"y\":3,\"points\":4,\"pope_group\":3,\"pope_check\":false},{\"order\":22,\"x\":17,\"y\":3,\"points\":0,\"pope_group\":3,\"pope_check\":false},{\"order\":23,\"x\":18,\"y\":3,\"points\":0,\"pope_group\":3,\"pope_check\":false},{\"order\":24,\"x\":19,\"y\":3,\"points\":4,\"pope_group\":3,\"pope_check\":true}],\"groups\":[{\"group\":1,\"points\":2},{\"group\":2,\"points\":3},{\"group\":3,\"points\":4}]}",
                "{\"cards\":[{\"id\":1,\"name\":\"aaa\",\"points\":2,\"requirements\":[{\"type\":\"flag\",\"color\":\"YELLOW\",\"amount\":1},{\"type\":\"flag\",\"color\":\"GREEN\",\"amount\":1}],\"special_abilities\":[{\"type\":\"discount\",\"resource\":\"servant\",\"amount\":1}]},{\"id\":2,\"name\":\"aaa\",\"points\":2,\"requirements\":[{\"type\":\"flag\",\"color\":\"BLUE\",\"amount\":1},{\"type\":\"flag\",\"color\":\"PURPLE\",\"amount\":1}],\"special_abilities\":[{\"type\":\"discount\",\"resource\":\"shield\",\"amount\":1}]},{\"id\":3,\"name\":\"aaa\",\"points\":2,\"requirements\":[{\"type\":\"flag\",\"color\":\"GREEN\",\"amount\":1},{\"type\":\"flag\",\"color\":\"BLUE\",\"amount\":1}],\"special_abilities\":[{\"type\":\"discount\",\"resource\":\"stone\",\"amount\":1}]},{\"id\":4,\"name\":\"aaa\",\"points\":2,\"requirements\":[{\"type\":\"flag\",\"color\":\"YELLOW\",\"amount\":1},{\"type\":\"flag\",\"color\":\"PURPLE\",\"amount\":1}],\"special_abilities\":[{\"type\":\"discount\",\"resource\":\"gold\",\"amount\":1}]},{\"id\":5,\"name\":\"bbb\",\"points\":3,\"requirements\":[{\"type\":\"resource\",\"resource\":\"gold\",\"amount\":5}],\"special_abilities\":[{\"type\":\"storage\",\"storage_name\":\"leader_5\",\"accepted_types\":\"stone\",\"amount\":2}]},{\"id\":6,\"name\":\"bbb\",\"points\":3,\"requirements\":[{\"type\":\"resource\",\"resource\":\"stone\",\"amount\":5}],\"special_abilities\":[{\"type\":\"storage\",\"storage_name\":\"leader_6\",\"accepted_types\":\"servant\",\"amount\":2}]},{\"id\":7,\"name\":\"bbb\",\"points\":3,\"requirements\":[{\"type\":\"resource\",\"resource\":\"servant\",\"amount\":5}],\"special_abilities\":[{\"type\":\"storage\",\"storage_name\":\"leader_7\",\"accepted_types\":\"shield\",\"amount\":2}]},{\"id\":8,\"name\":\"bbb\",\"points\":3,\"requirements\":[{\"type\":\"resource\",\"resource\":\"shield\",\"amount\":5}],\"special_abilities\":[{\"type\":\"storage\",\"storage_name\":\"leader_8\",\"accepted_types\":\"gold\",\"amount\":2}]},{\"id\":9,\"name\":\"ccc\",\"points\":5,\"requirements\":[{\"type\":\"flag\",\"color\":\"YELLOW\",\"amount\":2},{\"type\":\"flag\",\"color\":\"BLUE\",\"amount\":1}],\"special_abilities\":[{\"type\":\"conversion\",\"from\":\"WHITE\",\"to\":[\"servant\"],\"faith_output\":0}]},{\"id\":10,\"name\":\"ccc\",\"points\":5,\"requirements\":[{\"type\":\"flag\",\"color\":\"GREEN\",\"amount\":2},{\"type\":\"flag\",\"color\":\"PURPLE\",\"amount\":1}],\"special_abilities\":[{\"type\":\"conversion\",\"from\":\"WHITE\",\"to\":[\"shield\"],\"faith_output\":0}]},{\"id\":11,\"name\":\"ccc\",\"points\":5,\"requirements\":[{\"type\":\"flag\",\"color\":\"BLUE\",\"amount\":2},{\"type\":\"flag\",\"color\":\"YELLOW\",\"amount\":1}],\"special_abilities\":[{\"type\":\"conversion\",\"from\":\"WHITE\",\"to\":[\"stone\"],\"faith_output\":0}]},{\"id\":12,\"name\":\"ccc\",\"points\":5,\"requirements\":[{\"type\":\"flag\",\"color\":\"PURPLE\",\"amount\":2},{\"type\":\"flag\",\"color\":\"GREEN\",\"amount\":1}],\"special_abilities\":[{\"type\":\"conversion\",\"from\":\"WHITE\",\"to\":[\"gold\"],\"faith_output\":0}]},{\"id\":13,\"name\":\"ddd\",\"points\":4,\"requirements\":[{\"type\":\"level_flag\",\"color\":\"YELLOW\",\"level\":2,\"amount\":1}],\"special_abilities\":[{\"type\":\"crafting\",\"crafting\":{\"input\":{\"shield\":1},\"output\":{\"any\":1},\"faith_output\":1}}]},{\"id\":14,\"name\":\"ddd\",\"points\":4,\"requirements\":[{\"type\":\"level_flag\",\"color\":\"BLUE\",\"level\":2,\"amount\":1}],\"special_abilities\":[{\"type\":\"crafting\",\"crafting\":{\"input\":{\"servant\":1},\"output\":{\"any\":1},\"faith_output\":1}}]},{\"id\":15,\"name\":\"ddd\",\"points\":4,\"requirements\":[{\"type\":\"level_flag\",\"color\":\"PURPLE\",\"level\":2,\"amount\":1}],\"special_abilities\":[{\"type\":\"crafting\",\"crafting\":{\"input\":{\"stone\":1},\"output\":{\"any\":1},\"faith_output\":1}}]},{\"id\":16,\"name\":\"ddd\",\"points\":4,\"requirements\":[{\"type\":\"level_flag\",\"color\":\"GREEN\",\"level\":2,\"amount\":1}],\"special_abilities\":[{\"type\":\"crafting\",\"crafting\":{\"input\":{\"gold\":1},\"output\":{\"any\":1},\"faith_output\":1}}]}]}");

        GuiSceneManager sceneManager = new GuiSceneManager(stage);

        stage.setFullScreen(true);
        stage.setFullScreenExitHint("");

        GuiBuilder.createGameScene(sceneManager, model, null);
    }

    public static void main(String[] args) {
        launch();
    }

}